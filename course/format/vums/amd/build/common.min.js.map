{"version":3,"file":"common.min.js","sources":["../src/common.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Enhancements to Lists components for easy course accessibility.\n *\n * @module     format/vums\n * @copyright  WisdmLabs\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function($) {\n\n    var SELECTORS = {\n        ACTIVITY_TOGGLE: '.showactivity',\n        ACTIVITY_TOGGLE_CLASS: 'showhideactivity',\n        ACTIVITY_TOGGLE_WRAPPER: '.showactivitywrapper',\n        FIRST_SECTION: '#section-1',\n        SHOW: 'show',\n        TOGGLE_HIGHLIGHT: '.section_action_menu .dropdown-item.editing_highlight',\n        TOGGLE_SHOWHIDE: '.section_action_menu .dropdown-item.editing_showhide',\n        BUTTON_HIDE: '.cm_action_menu .dropdown-menu .editing_hide',\n        BUTTON_SHOW: '.cm_action_menu .dropdown-menu .editing_show',\n        DELETE: '.section_action_menu .dropdown-item[data-action=\"deleteSection\"]'\n    };\n\n    /**\n     * Get number activities can be shown in first row and hide rest\n     * @return {Integer} Number activities in first row\n     */\n    function getActivitiesPerRow() {\n        let width = $(window).width();\n        if ($('.vums-format-list').length) {\n            if (width >= 992) {\n                return 4;\n            }\n            if (width >= 768) {\n                return 3;\n            }\n            return 2;\n        } else {\n            if (width >= 768) {\n                return 4;\n            }\n            if (width >= 481) {\n                return 2;\n            }\n            return 1;\n        }\n    }\n\n    /**\n     * Adjust the general section activities visibility after first row\n     */\n    function adjustGeneralSectionActivities() {\n        if ($(SELECTORS.FIRST_SECTION + ' .activity').length <= getActivitiesPerRow()) {\n            $(SELECTORS.FIRST_SECTION).removeClass(SELECTORS.ACTIVITY_TOGGLE_CLASS);\n            $(SELECTORS.ACTIVITY_TOGGLE_WRAPPER).hide();\n        } else {\n            $(SELECTORS.ACTIVITY_TOGGLE_WRAPPER).show();\n            $(SELECTORS.FIRST_SECTION).addClass(SELECTORS.ACTIVITY_TOGGLE_CLASS);\n        }\n    }\n    /**\n     * Init method\n     *\n     */\n    function init() {\n\n        $('#page-course-view-vums .section-modchooser-link').addClass(\"btn btn-primary\");\n\n        adjustGeneralSectionActivities();\n        $(window).resize(function() {\n            adjustGeneralSectionActivities();\n        });\n\n        if ($(\".general-section-activities li:last\").css('display') == 'none') {\n            $(\".showactivitywrapper\").show();\n        } else {\n            $(\".showactivitywrapper\").hide();\n        }\n\n        // $(SELECTORS.ACTIVITY_TOGGLE).on('click', function() {\n        //\n        //     // if ($(this).hasClass(SELECTORS.SHOW)) {\n        //     //     $(this).html(M.util.get_string('showless', 'format_vums'));\n        //     //     $(this).toggleClass(SELECTORS.SHOW); // Remove show class\n        //     // } else {\n        //     //     $(this).html(M.util.get_string('showmore', 'format_vums'));\n        //     //     $(this).toggleClass(SELECTORS.SHOW); // Add show class\n        //     //     $(\"html, body\").animate({\n        //     //         scrollTop: $(SELECTORS.FIRST_SECTION + ' .activity:first-child').offset().top - 66\n        //     //     }, \"slow\");\n        //     // }\n        //     // $(SELECTORS.FIRST_SECTION).toggleClass(SELECTORS.ACTIVITY_TOGGLE_CLASS);\n        // });\n\n        // Handling highlight and show hide dropdown.\n        $('body').on('click', `${SELECTORS.TOGGLE_HIGHLIGHT},\n                               ${SELECTORS.TOGGLE_SHOWHIDE},\n                               ${SELECTORS.BUTTON_HIDE},\n                               ${SELECTORS.BUTTON_SHOW}`, function() {\n            location.reload();\n        });\n\n        // Handling deleteAction\n        $('body').on('click', `${SELECTORS.DELETE}`, function(event) {\n            event.preventDefault();\n            window.location.href = $(this).attr('href');\n            return true;\n        });\n\n\n        // ... + Show full summary label show conditionally.\n        var summaryheight = $('.read-more-target').height();\n        var browservendor = window.navigator.vendor;\n        var webkitboxorient = \"vertical\";\n        if (browservendor.indexOf('Apple') != -1) {\n            webkitboxorient = \"horizontal\";\n        }\n\n        if (summaryheight > 100) {\n            $('.generalsectioninfo').find('#readmorebtn').removeClass('d-none');\n            $('.read-more-target .no-overflow').addClass('text-clamp text-clamp-3').css(\"-webkit-box-orient\", webkitboxorient);\n            $('.read-more-target').addClass('text-clamp text-clamp-3').css(\"-webkit-box-orient\", webkitboxorient);\n        }\n        $('#readmorebtn').on('click', function() {\n            $('.read-more-target .no-overflow').removeClass('text-clamp text-clamp-3');\n            $('.read-more-target').removeClass('text-clamp text-clamp-3');\n            $('.generalsectioninfo').find('#readmorebtn').addClass('d-none');\n            $('.generalsectioninfo').find('#readlessbtn').removeClass('d-none');\n        });\n        $('#readlessbtn').on('click', function () {\n            $('.read-more-target .no-overflow').addClass('text-clamp text-clamp-3').css(\"-webkit-box-orient\", webkitboxorient);\n            $('.read-more-target').addClass('text-clamp text-clamp-3').css(\"-webkit-box-orient\", webkitboxorient);\n            $('.generalsectioninfo').find('#readmorebtn').removeClass('d-none');\n            $('.generalsectioninfo').find('#readlessbtn').addClass('d-none');\n        });\n\n    }\n\n    return {\n        init: init,\n        adjustGeneralSectionActivities: adjustGeneralSectionActivities\n    };\n});\n"],"names":["define","$","SELECTORS","adjustGeneralSectionActivities","length","width","window","getActivitiesPerRow","removeClass","hide","show","addClass","init","resize","css","on","location","reload","event","preventDefault","href","this","attr","summaryheight","height","browservendor","navigator","vendor","webkitboxorient","indexOf","find"],"mappings":";;;;;;;AAuBAA,4BAAO,CAAC,WAAW,SAASC,OAEpBC,gCAEuB,mBAFvBA,kCAGyB,uBAHzBA,wBAIe,aAJfA,2BAMkB,wDANlBA,0BAOiB,uDAPjBA,sBAQa,+CARbA,sBASa,+CATbA,iBAUQ,4EA+BHC,iCACDF,EAAEC,wBAA0B,cAAcE,uBAxB1CC,MAAQJ,EAAEK,QAAQD,eAClBJ,EAAE,qBAAqBG,OACnBC,OAAS,IACF,EAEPA,OAAS,IACF,EAEJ,EAEHA,OAAS,IACF,EAEPA,OAAS,IACF,EAEJ,EAQ6CE,IACpDN,EAAEC,yBAAyBM,YAAYN,iCACvCD,EAAEC,mCAAmCO,SAErCR,EAAEC,mCAAmCQ,OACrCT,EAAEC,yBAAyBS,SAAST,wCAiFrC,CACHU,gBAzEAX,EAAE,mDAAmDU,SAAS,mBAE9DR,iCACAF,EAAEK,QAAQO,QAAO,WACbV,oCAG2D,QAA3DF,EAAE,uCAAuCa,IAAI,WAC7Cb,EAAE,wBAAwBS,OAE1BT,EAAE,wBAAwBQ,OAmB9BR,EAAE,QAAQc,GAAG,kBAAYb,wEACAA,uEACAA,mEACAA,wBAAyB,WAC9Cc,SAASC,YAIbhB,EAAE,QAAQc,GAAG,kBAAYb,mBAAoB,SAASgB,cAClDA,MAAMC,iBACNb,OAAOU,SAASI,KAAOnB,EAAEoB,MAAMC,KAAK,SAC7B,SAKPC,cAAgBtB,EAAE,qBAAqBuB,SACvCC,cAAgBnB,OAAOoB,UAAUC,OACjCC,gBAAkB,YACiB,GAAnCH,cAAcI,QAAQ,WACtBD,gBAAkB,cAGlBL,cAAgB,MAChBtB,EAAE,uBAAuB6B,KAAK,gBAAgBtB,YAAY,UAC1DP,EAAE,kCAAkCU,SAAS,2BAA2BG,IAAI,qBAAsBc,iBAClG3B,EAAE,qBAAqBU,SAAS,2BAA2BG,IAAI,qBAAsBc,kBAEzF3B,EAAE,gBAAgBc,GAAG,SAAS,WAC1Bd,EAAE,kCAAkCO,YAAY,2BAChDP,EAAE,qBAAqBO,YAAY,2BACnCP,EAAE,uBAAuB6B,KAAK,gBAAgBnB,SAAS,UACvDV,EAAE,uBAAuB6B,KAAK,gBAAgBtB,YAAY,aAE9DP,EAAE,gBAAgBc,GAAG,SAAS,WAC1Bd,EAAE,kCAAkCU,SAAS,2BAA2BG,IAAI,qBAAsBc,iBAClG3B,EAAE,qBAAqBU,SAAS,2BAA2BG,IAAI,qBAAsBc,iBACrF3B,EAAE,uBAAuB6B,KAAK,gBAAgBtB,YAAY,UAC1DP,EAAE,uBAAuB6B,KAAK,gBAAgBnB,SAAS,cAO3DR,+BAAgCA"}